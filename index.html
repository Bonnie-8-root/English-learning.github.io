<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¶£å‘³è‹±è¯­æ—¶æ€å­¦ä¹  (Unit 5 ä¸“é¡¹ä¼˜åŒ–ç‰ˆ)</title>
  <style>
    body {
      font-family: 'Comic Sans MS', 'Chalkboard SE', 'Microsoft YaHei', sans-serif;
      background-color: #f0f8ff;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 20px;
      color: #333;
    }

    h1,
    h2,
    h3 {
      color: #ffa726;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    section {
      background-color: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
      padding: 30px;
      width: 95%;
      max-width: 900px;
      text-align: center;
      transition: transform 0.3s;
      border: 2px solid transparent;
    }

    section:hover {
      transform: translateY(-5px);
      border-color: #b2ebf2;
    }

    .svg-container {
      width: 100%;
      max-width: 800px;
      height: auto;
      margin: 20px auto;
      border: 3px solid #eee;
      border-radius: 15px;
      background-color: #e6f7ff;
      overflow: hidden;
      position: relative;
    }

    .button {
      background-color: #4ecdc4;
      border: none;
      color: white;
      padding: 12px 24px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 18px;
      margin: 10px;
      cursor: pointer;
      border-radius: 30px;
      transition: all 0.2s;
      box-shadow: 0 4px #36b3a9;
      user-select: none;
    }

    .button:hover {
      background-color: #36b3a9;
      transform: scale(1.05);
    }

    .button:active {
      box-shadow: 0 2px #2a8a83;
      transform: translateY(3px) scale(1);
    }

    /* Vocab Cards */
    .vocab-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .vocab-card {
      background: #fff;
      border: 2px solid #4ecdc4;
      border-radius: 15px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .vocab-card:hover {
      background: #e0f7fa;
      transform: scale(1.05);
    }

    .vocab-icon {
      font-size: 40px;
      display: block;
      margin-bottom: 10px;
    }

    .vocab-text {
      font-weight: bold;
      color: #00796b;
    }

    /* Time Marker Chips */
    .marker-container {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 20px;
    }

    .marker-box {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 15px;
      border: 2px dashed #ccc;
      width: 45%;
      min-width: 280px;
    }

    .marker-title {
      font-weight: bold;
      margin-bottom: 10px;
      display: block;
    }

    .chip {
      display: inline-block;
      padding: 5px 12px;
      margin: 4px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
      color: white;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .chip:hover {
      transform: scale(1.1);
    }

    .chip-now {
      background-color: #ffa726;
    }

    /* Present Continuous */
    .chip-often {
      background-color: #ff9800;
      color: #333;
    }

    /* Simple Present */

    /* Exercise Styles */
    .exercise-option {
      display: block;
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      background-color: #f9f9f9;
      border: 2px solid #ddd;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 18px;
      text-align: left;
      position: relative;
    }

    .exercise-option:hover {
      background-color: #e6f7ff;
      border-color: #4ecdc4;
      padding-left: 20px;
    }

    .exercise-option.correct {
      background-color: #d4edda;
      border-color: #28a745;
      color: #155724;
    }

    .exercise-option.incorrect {
      background-color: #fff3e0;
      border-color: #ff9800;
      color: #e65100;
    }

    /* Flashcard Styles */
    .filter-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }

    .filter-btn {
      background-color: #e0f7fa;
      border: 2px solid #4ecdc4;
      color: #00796b;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
    }

    .filter-btn:hover {
      background-color: #b2ebf2;
      transform: scale(1.05);
    }

    .filter-btn.active {
      background-color: #4ecdc4;
      color: white;
    }

    .flashcard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .flashcard-container {
      perspective: 1000px;
      height: 180px;
    }

    .flashcard {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s;
      cursor: pointer;
    }

    .flashcard.flipped {
      transform: rotateY(180deg);
    }

    .flashcard-front,
    .flashcard-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 15px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .flashcard-front {
      background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      color: white;
    }

    .flashcard-back {
      background: linear-gradient(135deg, #ffa726 0%, #ff9800 100%);
      color: white;
      transform: rotateY(180deg);
    }

    /* ä¸€èˆ¬ç°åœ¨æ—¶é—ªå¡æ ·å¼ */
    .flashcard-present .flashcard-front {
      background: linear-gradient(135deg, #ffa726 0%, #ff9800 100%);
      color: white;
    }

    .flashcard-present .flashcard-back {
      background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      color: white;
      transform: rotateY(180deg);
    }

    /* ç°åœ¨è¿›è¡Œæ—¶é—ªå¡æ ·å¼ï¼ˆä¿æŒåŸæ ·ï¼‰ */
    .flashcard-continuous .flashcard-front {
      background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      color: white;
    }

    .flashcard-continuous .flashcard-back {
      background: linear-gradient(135deg, #ffa726 0%, #ff9800 100%);
      color: white;
      transform: rotateY(180deg);
    }

    .verb-base {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .rule-tag {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 10px;
      font-size: 12px;
    }

    .verb-change {
      text-align: center;
      font-size: 16px;
    }

    .highlight {
      background: rgba(255,255,255,0.3);
      padding: 2px 6px;
      border-radius: 5px;
      font-weight: bold;
    }

    .flashcard-stats {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
    }

    .reset-btn {
      background-color: #ffa726;
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .reset-btn:hover {
      background-color: #ee5a52;
      transform: scale(1.05);
    }

    #score-board {
      font-size: 24px;
      font-weight: bold;
      color: #ffa726;
      margin-bottom: 20px;
      background: #fff0f0;
      padding: 10px 20px;
      border-radius: 50px;
      display: inline-block;
    }

    .clickable {
      cursor: pointer;
    }

    .clickable:hover {
      filter: brightness(1.1);
    }

    /* Animations */
    @keyframes bounce {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    .bouncing {
      animation: bounce 1s infinite;
    }
  </style>
</head>

<body>

  <h1>ğŸ€ Unit 5 è¶£å‘³è¯­æ³•çƒåœº ğŸ€</h1>
  <p style="color: #666; font-size: 14px;">ğŸ’¡ æç¤ºï¼šç‚¹å‡»å¡ç‰‡å’ŒæŒ‰é’®ï¼Œå¬å¬çº¯æ­£çš„å‘éŸ³ï¼</p>

  <!-- 1. è¯¾æ–‡é‡ç‚¹è¯å¥ (åŸºäºä¸Šä¼ å›¾ç‰‡) -->
  <section id="vocab-section">
    <h2>ğŸ“¸ è¯¾æ–‡é‡ç‚¹ï¼šç¯®çƒæ¯”èµ› (Basketball Match)</h2>
    <p>ç‚¹å‡»å¡ç‰‡ï¼Œå­¦ä¹  Lesson 2 ä¸­çš„æ ¸å¿ƒåŠ¨ä½œï¼</p>

    <div class="vocab-grid">
      <div class="vocab-card" onclick="speakText('jump high')">
        <span class="vocab-icon">ğŸ¦˜</span>
        <span class="vocab-text">jump high</span>
        <br><span style="font-size:12px; color:#666;">è·³å¾—é«˜</span>
      </div>
      <div class="vocab-card" onclick="speakText('get the ball')">
        <span class="vocab-icon">ğŸ€</span>
        <span class="vocab-text">get the ball</span>
        <br><span style="font-size:12px; color:#666;">æ‹¿åˆ°çƒ</span>
      </div>
      <div class="vocab-card" onclick="speakText('run to the basket')">
        <span class="vocab-icon">ğŸƒ</span>
        <span class="vocab-text">run to the basket</span>
        <br><span style="font-size:12px; color:#666;">è·‘å‘ç¯®ç­</span>
      </div>
      <div class="vocab-card" onclick="speakText('shoot the ball')">
        <span class="vocab-icon">â›¹ï¸</span>
        <span class="vocab-text">shoot the ball</span>
        <br><span style="font-size:12px; color:#666;">æŠ•ç¯®</span>
      </div>
    </div>

    <div style="background: #fff8e1; padding: 15px; border-radius: 10px; margin-top: 10px;">
      <h3 style="margin:0 0 10px 0;">ğŸ’¬ é‡ç‚¹å¥å‹å¯¹æ¯”</h3>
      <div style="display: flex; justify-content: space-around; text-align: left;">
        <div class="clickable" onclick="speakText('He is running to the basket.')">
          <span style="color: #ffa726; font-weight: bold;">æ­£åœ¨åšï¼š</span><br>
          He is <b>running</b> to the basket.<br>
          <span style="font-size:12px; color:#666;">ä»–æ­£åœ¨è·‘å‘ç¯®ç­ã€‚</span>
        </div>
        <div class="clickable" onclick="speakText('He plays basketball well.')">
          <span style="color: #ff6b00; font-weight: bold;">èƒ½åŠ›/äº‹å®ï¼š</span><br>
          He <b>plays</b> basketball well.<br>
          <span style="font-size:12px; color:#666;">ä»–ç¯®çƒæ‰“å¾—å¾ˆå¥½ã€‚</span>
        </div>
      </div>
    </div>
  </section>

  <!-- 2. è¯­æ³•æ ¸å¿ƒå¯¹æ¯” + æ—¶é—´æ ‡å¿—è¯ -->
  <section id="comparison-section">
    <h2>ğŸ•°ï¸ è¯­æ³•ä¾¦æ¢ï¼šå¯»æ‰¾æ—¶é—´çº¿ç´¢</h2>
    <p>çœ‹åˆ°è¿™äº›â€œæ—¶é—´å…³é”®è¯â€ï¼Œä½ å°±çŸ¥é“è¯¥ç”¨ä»€ä¹ˆæ—¶æ€äº†ï¼</p>

    <div class="marker-container">
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶ -->
      <div class="marker-box" style="background-color: #fff3e0; border-color: #ff9800;">
        <span class="marker-title" style="color: #ff6b00;">ğŸŸ¡ ä¸€èˆ¬ç°åœ¨æ—¶ (Simple Present)</span>
        <p style="font-size: 12px; margin: 5px 0;">å…³é”®è¯ï¼šä¹ æƒ¯ã€ç»å¸¸ã€èƒ½åŠ›</p>
        <div>
          <span class="chip chip-often" onclick="speakText('usually')">usually (é€šå¸¸)</span>
          <span class="chip chip-often" onclick="speakText('often')">often (ç»å¸¸)</span>
          <span class="chip chip-often" onclick="speakText('every day')">every day (æ¯å¤©)</span>
          <span class="chip chip-often" onclick="speakText('always')">always (æ€»æ˜¯)</span>
          <span class="chip chip-often" onclick="speakText('on Mondays')">on Mondays (æ¯å‘¨ä¸€)</span>
        </div>
        <hr style="border: 0; border-top: 1px dashed #ccc; margin: 10px 0;">
        <div style="font-size: 14px;">
          ä¾‹å¥ï¼šHe <b>jumps</b> high. (ä»–è·³å¾—é«˜ - èƒ½åŠ›)
        </div>
      </div>

      <!-- ç°åœ¨è¿›è¡Œæ—¶ -->
      <div class="marker-box" style="background-color: #e8f5e8; border-color: #4caf50;">
        <span class="marker-title" style="color: #2e7d32;">ğŸŸ¢ ç°åœ¨è¿›è¡Œæ—¶ (Present Continuous)</span>
        <p style="font-size: 12px; margin: 5px 0;">å…³é”®è¯ï¼šæ­¤æ—¶æ­¤åˆ»æ­£åœ¨å‘ç”Ÿ</p>
        <div>
          <span class="chip chip-now" onclick="speakText('Look!')">Look! (çœ‹!)</span>
          <span class="chip chip-now" onclick="speakText('Listen!')">Listen! (å¬!)</span>
          <span class="chip chip-now" onclick="speakText('now')">now (ç°åœ¨)</span>
          <span class="chip chip-now" onclick="speakText('right now')">right now (ç«‹åˆ»)</span>
          <span class="chip chip-now" onclick="speakText('at the moment')">at the moment (æ­¤åˆ»)</span>
        </div>
        <hr style="border: 0; border-top: 1px dashed #ccc; margin: 10px 0;">
        <div style="font-size: 14px;">
          ä¾‹å¥ï¼šLook! He <b>is shooting</b>! (çœ‹! ä»–æ­£åœ¨æŠ•ç¯®)
        </div>
      </div>
    </div>
  </section>

  <!-- 3. æ—¶æ€å¯¹æ¯”å¤§æŒ‘æˆ˜ -->
  <section id="tense-comparison-section" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
    <h2>ğŸ¯ æ—¶æ€å¯¹æ¯”å¤§æŒ‘æˆ˜ï¼šä¸€èˆ¬ç°åœ¨æ—¶ vs ç°åœ¨è¿›è¡Œæ—¶</h2>
    <p>æŒæ¡ä¸¤ç§æ—¶æ€çš„æ ¸å¿ƒå·®å¼‚ï¼Œæˆä¸ºè¯­æ³•é«˜æ‰‹ï¼</p>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶ -->
      <div style="background: #fff3e0; border: 3px solid #ff9800; border-radius: 15px; padding: 20px;">
        <h3 style="color: #ff6b00; text-align: center;">ğŸŸ¡ ä¸€èˆ¬ç°åœ¨æ—¶</h3>
        <div style="background: #fff8e1; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #f57c00; margin: 0 0 10px 0;">ğŸ“Œ ä½¿ç”¨è¯­å¢ƒ</h4>
          <ul style="text-align: left; margin: 0; padding-left: 20px;">
            <li>ä¹ æƒ¯æ€§åŠ¨ä½œ (usually, often)</li>
            <li>å®¢è§‚äº‹å® (always, every day)</li>
            <li>èƒ½åŠ›/çŠ¶æ€ (can, be good at)</li>
            <li>æ™®éçœŸç† (the sun rises)</li>
          </ul>
        </div>
        <div style="background: #fff8e1; padding: 15px; border-radius: 10px;">
          <h4 style="color: #f57c00; margin: 0 0 10px 0;">ğŸ’¡ å…¸å‹ä¾‹å¥</h4>
          <p style="margin: 5px 0;">He <b>plays</b> basketball well.</p>
          <p style="margin: 5px 0;">She <b>goes</b> to school every day.</p>
          <p style="margin: 5px 0;">The sun <b>rises</b> in the east.</p>
        </div>
      </div>
      
      <!-- ç°åœ¨è¿›è¡Œæ—¶ -->
      <div style="background: #e8f5e8; border: 3px solid #4caf50; border-radius: 15px; padding: 20px;">
        <h3 style="color: #2e7d32; text-align: center;">ğŸŸ¢ ç°åœ¨è¿›è¡Œæ—¶</h3>
        <div style="background: #f1f8e9; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #388e3c; margin: 0 0 10px 0;">ğŸ“Œ ä½¿ç”¨è¯­å¢ƒ</h4>
          <ul style="text-align: left; margin: 0; padding-left: 20px;">
            <li>æ­£åœ¨è¿›è¡Œçš„åŠ¨ä½œ (now, right now)</li>
            <li>æš‚æ—¶æ€§æƒ…å†µ (at the moment)</li>
            <li>è®¡åˆ’ä¸­çš„å®‰æ’ (tomorrow)</li>
            <li>å˜åŒ–çš„è¿‡ç¨‹ (getting better)</li>
          </ul>
        </div>
        <div style="background: #f1f8e9; padding: 15px; border-radius: 10px;">
          <h4 style="color: #388e3c; margin: 0 0 10px 0;">ğŸ’¡ å…¸å‹ä¾‹å¥</h4>
          <p style="margin: 5px 0;">He <b>is playing</b> basketball now.</p>
          <p style="margin: 5px 0;">She <b>is studying</b> English.</p>
          <p style="margin: 5px 0;">They <b>are watching</b> TV.</p>
        </div>
      </div>
    </div>
    
    <div style="background: #fff; border: 2px dashed #2196f3; border-radius: 15px; padding: 20px; margin-top: 20px;">
      <h4 style="color: #1976d2; text-align: center;">ğŸ“ è¯­å¢ƒå·®å¼‚æ€»ç»“</h4>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center;">
        <div>
          <p style="font-weight: bold; color: #ff6b00;">ä¸€èˆ¬ç°åœ¨æ—¶</p>
          <p style="font-size: 14px;">æè¿°<strong>é•¿æœŸã€ä¹ æƒ¯æ€§</strong>çš„åŠ¨ä½œ</p>
        </div>
        <div>
          <p style="font-weight: bold; color: #2e7d32;">ç°åœ¨è¿›è¡Œæ—¶</p>
          <p style="font-size: 14px;">æè¿°<strong>å½“å‰ã€æ­£åœ¨è¿›è¡Œ</strong>çš„åŠ¨ä½œ</p>
        </div>
      </div>
    </div>
  </section>

  <!-- 4. åŠ¨è¯å˜å½¢Flashcardé—ªå¡ -->
  <section id="flashcard-section">
    <h2>âœ¨ åŠ¨è¯å˜å½¢é—ªå¡ç»ƒä¹  âœ¨</h2>
    <p>ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹åŠ¨è¯çš„ä¸‰å•å˜åŒ–å’Œç°åœ¨åˆ†è¯å˜åŒ–ï¼</p>
    
    <!-- è§„åˆ™ç­›é€‰å™¨ -->
    <div class="filter-container">
      <button class="filter-btn active" onclick="filterCards('all')">å…¨éƒ¨è§„åˆ™</button>
      <button class="filter-btn" onclick="filterCards('present')">ä¸€èˆ¬ç°åœ¨æ—¶</button>
      <button class="filter-btn" onclick="filterCards('continuous')">ç°åœ¨è¿›è¡Œæ—¶</button>
    </div>
    
    <!-- Flashcardç½‘æ ¼ -->
    <div class="flashcard-grid">
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶ï¼šç›´æ¥åŠ sè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="present" data-subrule="s">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">play</div>
            <div class="rule-tag">ç›´æ¥åŠ s</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">plays</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="s">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">work</div>
            <div class="rule-tag">ç›´æ¥åŠ s</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">works</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="s">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">read</div>
            <div class="rule-tag">ç›´æ¥åŠ s</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">reads</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶ï¼šåŠ esè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="present" data-subrule="es">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">go</div>
            <div class="rule-tag">åŠ es</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">goes</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="es">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">watch</div>
            <div class="rule-tag">åŠ es</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">watches</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="es">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">wash</div>
            <div class="rule-tag">åŠ es</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">washes</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶ï¼šå˜iesè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="present" data-subrule="ies">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">study</div>
            <div class="rule-tag">å˜ies</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">studies</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="ies">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">try</div>
            <div class="rule-tag">å˜ies</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">tries</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="ies">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">fly</div>
            <div class="rule-tag">å˜ies</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">flies</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶ï¼šç‰¹æ®Šå˜åŒ–è¯æ±‡ -->
      <div class="flashcard-container" data-rule="present" data-subrule="special">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">have</div>
            <div class="rule-tag">ç‰¹æ®Šå˜åŒ–</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">has</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="special">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">do</div>
            <div class="rule-tag">ç‰¹æ®Šå˜åŒ–</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">does</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="present" data-subrule="special">
        <div class="flashcard flashcard-present" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">be</div>
            <div class="rule-tag">ç‰¹æ®Šå˜åŒ–</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ä¸‰å•: <span class="highlight">is</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ç°åœ¨è¿›è¡Œæ—¶ï¼šç›´æ¥åŠ ingè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="continuous" data-subrule="ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">play</div>
            <div class="rule-tag">ç›´æ¥åŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">playing</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">work</div>
            <div class="rule-tag">ç›´æ¥åŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">working</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">read</div>
            <div class="rule-tag">ç›´æ¥åŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">reading</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ç°åœ¨è¿›è¡Œæ—¶ï¼šå»eåŠ ingè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="continuous" data-subrule="e-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">make</div>
            <div class="rule-tag">å»eåŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">making</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="e-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">write</div>
            <div class="rule-tag">å»eåŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">writing</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="e-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">dance</div>
            <div class="rule-tag">å»eåŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">dancing</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ç°åœ¨è¿›è¡Œæ—¶ï¼šåŒå†™åŠ ingè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="continuous" data-subrule="double-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">run</div>
            <div class="rule-tag">åŒå†™åŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">running</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="double-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">swim</div>
            <div class="rule-tag">åŒå†™åŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">swimming</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="double-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">get</div>
            <div class="rule-tag">åŒå†™åŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">getting</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ç°åœ¨è¿›è¡Œæ—¶ï¼šieå˜yåŠ ingè§„åˆ™è¯æ±‡ -->
      <div class="flashcard-container" data-rule="continuous" data-subrule="ie-y-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">die</div>
            <div class="rule-tag">ieå˜yåŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">dying</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="ie-y-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">lie</div>
            <div class="rule-tag">ieå˜yåŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">lying</span></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="flashcard-container" data-rule="continuous" data-subrule="ie-y-ing">
        <div class="flashcard flashcard-continuous" onclick="flipCard(this)">
          <div class="flashcard-front">
            <div class="verb-base">tie</div>
            <div class="rule-tag">ieå˜yåŠ ing</div>
          </div>
          <div class="flashcard-back">
            <div class="verb-change">
              <div>ç°åœ¨åˆ†è¯: <span class="highlight">tying</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="flashcard-stats">
      <span>å·²é€‰æ‹©: <span id="selected-count">0</span>/24 ä¸ªè¯æ±‡</span>
      <button class="reset-btn" onclick="resetAllCards()">é‡ç½®æ‰€æœ‰å¡ç‰‡</button>
    </div>
  </section>

  <!-- 5. åŠ¨è¯å˜åŒ–è§„åˆ™å¯¹æ¯” -->
  <section id="rules-comparison-section" style="background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);">
    <h2>ğŸ“Š åŠ¨è¯å˜åŒ–è§„åˆ™å¯¹æ¯”</h2>
    <p>æŒæ¡ä¸¤ç§æ—¶æ€çš„åŠ¨è¯å˜åŒ–è§„å¾‹ï¼Œè½»æ¾åº”å¯¹å„ç§è¯­æ³•é¢˜ï¼</p>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
      <!-- ä¸€èˆ¬ç°åœ¨æ—¶è§„åˆ™ -->
      <div style="background: #fff3e0; border: 3px solid #ff9800; border-radius: 15px; padding: 20px;">
        <h3 style="color: #ff6b00; text-align: center;">ğŸŸ¡ ä¸€èˆ¬ç°åœ¨æ—¶è§„åˆ™</h3>
        
        <div style="background: #fff8e1; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #f57c00; margin: 0 0 10px 0;">âœ… è§„åˆ™1ï¼šç›´æ¥åŠ s</h4>
          <p style="margin: 5px 0;">å¤§å¤šæ•°åŠ¨è¯ï¼šplay â†’ <b>plays</b></p>
          <p style="margin: 5px 0;">work â†’ <b>works</b>, read â†’ <b>reads</b></p>
        </div>
        
        <div style="background: #fff8e1; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #f57c00; margin: 0 0 10px 0;">âœ… è§„åˆ™2ï¼šä»¥s/x/ch/sh/oç»“å°¾åŠ es</h4>
          <p style="margin: 5px 0;">go â†’ <b>goes</b>, watch â†’ <b>watches</b></p>
          <p style="margin: 5px 0;">wash â†’ <b>washes</b>, fix â†’ <b>fixes</b></p>
        </div>
        
        <div style="background: #fff8e1; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #f57c00; margin: 0 0 10px 0;">âœ… è§„åˆ™3ï¼šä»¥è¾…éŸ³+yç»“å°¾å˜ies</h4>
          <p style="margin: 5px 0;">study â†’ <b>studies</b>, try â†’ <b>tries</b></p>
          <p style="margin: 5px 0;">fly â†’ <b>flies</b>, cry â†’ <b>cries</b></p>
        </div>
        
        <div style="background: #fff8e1; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #f57c00; margin: 0 0 10px 0;">âœ… è§„åˆ™4ï¼šç‰¹æ®Šå˜åŒ–</h4>
          <p style="margin: 5px 0;">have â†’ <b>has</b>, do â†’ <b>does</b></p>
          <p style="margin: 5px 0;">be â†’ <b>is</b> (he/she/it)</p>
        </div>
      </div>
      
      <!-- ç°åœ¨è¿›è¡Œæ—¶è§„åˆ™ -->
      <div style="background: #e8f5e8; border: 3px solid #4caf50; border-radius: 15px; padding: 20px;">
        <h3 style="color: #2e7d32; text-align: center;">ğŸŸ¢ ç°åœ¨è¿›è¡Œæ—¶è§„åˆ™</h3>
        
        <div style="background: #f1f8e9; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #388e3c; margin: 0 0 10px 0;">âœ… è§„åˆ™1ï¼šç›´æ¥åŠ ing</h4>
          <p style="margin: 5px 0;">å¤§å¤šæ•°åŠ¨è¯ï¼šplay â†’ <b>playing</b></p>
          <p style="margin: 5px 0;">work â†’ <b>working</b>, read â†’ <b>reading</b></p>
        </div>
        
        <div style="background: #f1f8e9; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #388e3c; margin: 0 0 10px 0;">âœ… è§„åˆ™2ï¼šä»¥ä¸å‘éŸ³eç»“å°¾å»eåŠ ing</h4>
          <p style="margin: 5px 0;">make â†’ <b>making</b>, write â†’ <b>writing</b></p>
          <p style="margin: 5px 0;">dance â†’ <b>dancing</b>, take â†’ <b>taking</b></p>
        </div>
        
        <div style="background: #f1f8e9; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #388e3c; margin: 0 0 10px 0;">âœ… è§„åˆ™3ï¼šé‡è¯»é—­éŸ³èŠ‚åŒå†™åŠ ing</h4>
          <p style="margin: 5px 0;">run â†’ <b>running</b>, swim â†’ <b>swimming</b></p>
          <p style="margin: 5px 0;">get â†’ <b>getting</b>, sit â†’ <b>sitting</b></p>
        </div>
        
        <div style="background: #f1f8e9; padding: 15px; border-radius: 10px; margin: 10px 0;">
          <h4 style="color: #388e3c; margin: 0 0 10px 0;">âœ… è§„åˆ™4ï¼šç‰¹æ®Šå˜åŒ–</h4>
          <p style="margin: 5px 0;">die â†’ <b>dying</b>, lie â†’ <b>lying</b></p>
          <p style="margin: 5px 0;">tie â†’ <b>tying</b>, picnic â†’ <b>picnicking</b></p>
        </div>
      </div>
    </div>
    
    <div style="background: #fff; border: 2px dashed #9c27b0; border-radius: 15px; padding: 20px; margin-top: 20px;">
      <h4 style="color: #7b1fa2; text-align: center;">ğŸ¯ è§„åˆ™å¯¹æ¯”æ€»ç»“</h4>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center;">
        <div>
          <p style="font-weight: bold; color: #ff6b00;">ä¸€èˆ¬ç°åœ¨æ—¶</p>
          <p style="font-size: 14px;">å…³æ³¨<strong>ä¸»è¯­äººç§°</strong>çš„å˜åŒ–</p>
          <p style="font-size: 12px; color: #666;">ç¬¬ä¸‰äººç§°å•æ•°è¦åŠ s/es</p>
        </div>
        <div>
          <p style="font-weight: bold; color: #2e7d32;">ç°åœ¨è¿›è¡Œæ—¶</p>
          <p style="font-size: 14px;">å…³æ³¨<strong>åŠ¨è¯å½¢å¼</strong>çš„å˜åŒ–</p>
          <p style="font-size: 12px; color: #666;">åŠ¨è¯è¦åŠ ingå½¢å¼</p>
        </div>
      </div>
    </div>
  </section>

  <!-- 6. å† å†›æŒ‘æˆ˜èµ› -->
  <section id="exercise-section" style="background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);">
    <h2>ğŸ† å† å†›æŒ‘æˆ˜èµ› ğŸ†</h2>
    
    <!-- é€‰é¡¹å¡å¯¼èˆª -->
    <div style="display: flex; justify-content: center; margin-bottom: 20px; background: #fff; border-radius: 50px; padding: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
      <button id="past-tab" class="tab-button active" onclick="switchTab('past')" style="flex: 1; padding: 15px; border: none; background: #ffa726; color: white; border-radius: 50px; font-size: 16px; cursor: pointer; margin: 0 5px;">
        ä¸€èˆ¬ç°åœ¨æ—¶ç»ƒä¹  (10é¢˜)
      </button>
      <button id="comparison-tab" class="tab-button" onclick="switchTab('comparison')" style="flex: 1; padding: 15px; border: none; background: #4ecdc4; color: white; border-radius: 50px; font-size: 16px; cursor: pointer; margin: 0 5px;">
        æ—¶æ€å¯¹æ¯”ç»ƒä¹  (10é¢˜)
      </button>
    </div>
    
    <!-- ä¸€èˆ¬ç°åœ¨æ—¶ç»ƒä¹ å†…å®¹ -->
    <div id="past-tab-content" style="display: block;">
      <div id="score-board" style="background: #ffa726; color: white;">å¾—åˆ†: <span id="score">0</span> / 10</div>
      <div id="question-container">
        <h3 id="question-text">é—®é¢˜åŠ è½½ä¸­...</h3>
        <div id="options-container"></div>
      </div>
      <button id="next-button" class="button" style="display:none;" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ &gt;</button>
      <div id="result-message" style="font-size: 20px; margin-top: 20px;"></div>
    </div>
    
    <!-- æ—¶æ€å¯¹æ¯”ç»ƒä¹ å†…å®¹ -->
    <div id="comparison-tab-content" style="display: none;">
      <div id="comparison-score-board" style="background: #4ecdc4; color: white;">å¾—åˆ†: <span id="comparison-score">0</span> / 10</div>
      <div id="comparison-question-container">
        <h3 id="comparison-question-text">é—®é¢˜åŠ è½½ä¸­...</h3>
        <div id="comparison-options-container"></div>
      </div>
      <button id="comparison-next-button" class="button" style="display:none;" onclick="nextComparisonQuestion()">ä¸‹ä¸€é¢˜ &gt;</button>
      <div id="comparison-result-message" style="font-size: 20px; margin-top: 20px;"></div>
    </div>
  </section>

  <script>
    // --- é›¶ä¾èµ–éŸ³é¢‘ç³»ç»Ÿ ---
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx;
    
    // å¤‡é€‰éŸ³é¢‘æ–¹æ¡ˆï¼šä½¿ç”¨HTML5 Audioå…ƒç´ 
    function createAudioElement(src) {
      const audio = new Audio();
      audio.src = src;
      audio.preload = 'auto';
      return audio;
    }
    
    // é¢„åŠ è½½éŸ³é¢‘æ–‡ä»¶ï¼ˆä½¿ç”¨base64ç¼–ç çš„çŸ­éŸ³é¢‘ï¼‰
    const audioFiles = {
      correct: 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=',
      incorrect: 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=',
      magic: 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA='
    };

    function initAudio() {
      if (!audioCtx) { audioCtx = new AudioContext(); }
      if (audioCtx.state === 'suspended') { audioCtx.resume(); }
    }

    function playSoundEffect(type) {
      // é¦–å…ˆå°è¯•Web Audio API
      if (audioCtx) {
        try {
          // æ£€æŸ¥éŸ³é¢‘ä¸Šä¸‹æ–‡çŠ¶æ€ï¼Œç¡®ä¿å¯ä»¥æ’­æ”¾
          if (audioCtx.state === 'suspended') {
            audioCtx.resume();
          }
          
          // åˆ›å»ºéŸ³é¢‘èŠ‚ç‚¹
          const osc = audioCtx.createOscillator();
          const gainNode = audioCtx.createGain();
          osc.connect(gainNode);
          gainNode.connect(audioCtx.destination);
          const now = audioCtx.currentTime;

      if (type === 'correct') {
        // æ¸…è„†çš„æ­£ç¡®æç¤ºéŸ³ - ç±»ä¼¼"å®"çš„æ¸…è„†å£°éŸ³
        osc.type = 'sine';
        osc.frequency.setValueAtTime(880, now); // A5éŸ³
        osc.frequency.linearRampToValueAtTime(1320, now + 0.05); // E6éŸ³
        osc.frequency.linearRampToValueAtTime(1760, now + 0.15); // A6éŸ³
        gainNode.gain.setValueAtTime(0.4, now);
        gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.25);
        osc.start(now); osc.stop(now + 0.25);
      } else if (type === 'incorrect') {
        // çŸ­ä¿ƒçš„é”™è¯¯æç¤ºéŸ³ - ç±»ä¼¼"å˜Ÿ"çš„çŸ­ä¿ƒå£°éŸ³
        osc.type = 'square';
        osc.frequency.setValueAtTime(220, now); // A3éŸ³
        osc.frequency.linearRampToValueAtTime(165, now + 0.08); // E3éŸ³
        gainNode.gain.setValueAtTime(0.3, now);
        gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.15);
        osc.start(now); osc.stop(now + 0.15);
      } else if (type === 'magic') {
        osc.type = 'triangle';
        osc.frequency.setValueAtTime(300, now);
        osc.frequency.linearRampToValueAtTime(800, now + 0.3);
        gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
        osc.start(now); osc.stop(now + 0.3);
      }
        } catch (error) {
          console.log('Web Audio APIæ’­æ”¾å¼‚å¸¸ï¼Œå°è¯•å¤‡é€‰æ–¹æ¡ˆï¼š', error);
          // Web Audio APIå¤±è´¥æ—¶ï¼Œä½¿ç”¨HTML5 Audioå¤‡é€‰æ–¹æ¡ˆ
          playSoundEffectFallback(type);
        }
      } else {
        // Web Audio APIä¸å¯ç”¨æ—¶ï¼Œç›´æ¥ä½¿ç”¨å¤‡é€‰æ–¹æ¡ˆ
        playSoundEffectFallback(type);
      }
    }
    
    // HTML5 Audioå¤‡é€‰æ–¹æ¡ˆ
    function playSoundEffectFallback(type) {
      try {
        // ä½¿ç”¨ç®€å•çš„HTML5 Audioæ’­æ”¾çŸ­ä¿ƒéŸ³æ•ˆ
        const audio = new Audio();
        audio.volume = 0.3;
        
        // åˆ›å»ºç®€å•çš„éŸ³æ•ˆï¼ˆä½¿ç”¨data URIï¼‰
        let frequency = 800;
        let duration = 0.2;
        
        if (type === 'correct') {
          frequency = 1000; // é«˜éŸ³
        } else if (type === 'incorrect') {
          frequency = 400;  // ä½éŸ³
        } else if (type === 'magic') {
          frequency = 600;  // ä¸­éŸ³
        }
        
        // ä½¿ç”¨ç®€å•çš„éŸ³é¢‘æ•°æ®URIï¼ˆçŸ­ä¿ƒçš„å“”å£°ï¼‰
        const audioData = `data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQ${frequency}AAAAAA==`;
        audio.src = audioData;
        
        audio.play().catch(error => {
          console.log('HTML5 Audioæ’­æ”¾å¤±è´¥ï¼š', error);
        });
        
        // è®¾ç½®è‡ªåŠ¨åœæ­¢
        setTimeout(() => {
          audio.pause();
          audio.currentTime = 0;
        }, duration * 1000);
        
      } catch (error) {
        console.log('å¤‡é€‰éŸ³é¢‘æ–¹æ¡ˆå¼‚å¸¸ï¼š', error);
      }
    }

    function speakText(text) {
      // å…¼å®¹æ€§æ£€æŸ¥ï¼šå®‰å“æ‰‹æœºæµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒWeb Speech API
      if (!window.speechSynthesis) {
        console.log('è¯­éŸ³åˆæˆAPIä¸æ”¯æŒï¼Œæ–‡æœ¬ï¼š' + text);
        speakTextFallback(text); // ä½¿ç”¨å¤‡é€‰æ–¹æ¡ˆ
        return;
      }
      
      try {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        
        // iOS Safariä¸“ç”¨ä¼˜åŒ–
        if (isIOS()) {
          console.log('iOSè®¾å¤‡è¯­éŸ³ä¼˜åŒ–ï¼š', text);
          // iOS Safariéœ€è¦æ›´ä¿å®ˆçš„é…ç½®
          utterance.lang = 'en-US';
          utterance.rate = 0.6; // æ›´æ…¢çš„è¯­é€Ÿï¼Œæé«˜iOSä¸Šçš„æ¸…æ™°åº¦
          utterance.pitch = 0.8; // é™ä½éŸ³è°ƒ
          utterance.volume = 0.8; // é™ä½éŸ³é‡é¿å…çˆ†éŸ³
        } else {
          // å…¶ä»–è®¾å¤‡çš„é…ç½®
          utterance.lang = 'en-US';
          utterance.rate = 0.8; // ç¨å¾®é™ä½è¯­é€Ÿï¼Œæé«˜æ¸…æ™°åº¦
          utterance.pitch = 1.0;
          utterance.volume = 1.0;
        }
        
        // ç‰¹æ®Šå¤„ç†ï¼šé’ˆå¯¹ç‰¹å®šå•è¯çš„å‘éŸ³çº æ­£
        if (text.includes('read') || text.includes('reads') || text.includes('reading')) {
          console.log('å¤„ç†readç›¸å…³å•è¯å‘éŸ³ï¼š', text);
          utterance.rate = 0.7; // æ›´æ…¢çš„è¯­é€Ÿ
          utterance.pitch = 0.9; // ç¨å¾®é™ä½éŸ³è°ƒ
        } else if (text.includes('do') || text.includes('does')) {
          console.log('å¤„ç†do/doeså•è¯å‘éŸ³ï¼š', text);
          utterance.rate = 0.7;
          utterance.pitch = 0.9;
        } else if (text.includes('basket')) {
          console.log('å¤„ç†basketå•è¯å‘éŸ³ï¼š', text);
          utterance.rate = 0.8;
          utterance.pitch = 0.95;
        }
        
        utterance.onerror = function(event) {
          console.log('è¯­éŸ³åˆæˆé”™è¯¯ï¼š', event.error, 'æ–‡æœ¬ï¼š', text);
          speakTextFallback(text); // Web Speech APIå¤±è´¥æ—¶ä½¿ç”¨å¤‡é€‰æ–¹æ¡ˆ
        };
        
        utterance.onend = function() {
          console.log('è¯­éŸ³æ’­æ”¾å®Œæˆï¼š', text);
        };
        
        // iOS Safariå¯èƒ½éœ€è¦å»¶è¿Ÿæ’­æ”¾
        if (isIOS()) {
          setTimeout(() => {
            window.speechSynthesis.speak(utterance);
          }, 100);
        } else {
          window.speechSynthesis.speak(utterance);
        }
      } catch (error) {
        console.log('è¯­éŸ³åˆæˆå¼‚å¸¸ï¼š', error, 'æ–‡æœ¬ï¼š', text);
        speakTextFallback(text); // å¼‚å¸¸æ—¶ä½¿ç”¨å¤‡é€‰æ–¹æ¡ˆ
      }
    }
    
    // è¯­éŸ³åˆæˆå¤‡é€‰æ–¹æ¡ˆï¼šä½¿ç”¨åœ¨çº¿TTSæœåŠ¡
    function speakTextFallback(text) {
      console.log('ä½¿ç”¨å¤‡é€‰è¯­éŸ³æ–¹æ¡ˆï¼š', text);
      
      // ç®€å•çš„æ–‡æœ¬æç¤ºï¼ˆä½œä¸ºæœ€åçš„æ‰‹æ®µï¼‰
      if (text.includes('read') && text.includes('reads')) {
        alert('æç¤ºï¼šread è¯»ä½œ /riËd/ï¼Œreads è¯»ä½œ /riËdz/');
      } else if (text.includes('read') && text.includes('reading')) {
        alert('æç¤ºï¼šread è¯»ä½œ /riËd/ï¼Œreading è¯»ä½œ /ËˆriËdÉªÅ‹/');
      } else if (text === 'read') {
        alert('æç¤ºï¼šread è¯»ä½œ /riËd/ï¼ˆé•¿éŸ³ï¼‰');
      } else if (text === 'reads') {
        alert('æç¤ºï¼šreads è¯»ä½œ /riËdz/ï¼ˆé•¿éŸ³ï¼‰');
      } else if (text.includes('do') && text.includes('does')) {
        alert('æç¤ºï¼šdo è¯»ä½œ /duË/ï¼Œdoes è¯»ä½œ /dÊŒz/');
      } else if (text === 'do') {
        alert('æç¤ºï¼šdo è¯»ä½œ /duË/');
      } else if (text === 'does') {
        alert('æç¤ºï¼šdoes è¯»ä½œ /dÊŒz/');
      } else if (text.includes('basket')) {
        alert('æç¤ºï¼šbasket è¯»ä½œ /ËˆbÉ‘ËskÉªt/');
      }
      
      // è¿™é‡Œå¯ä»¥é›†æˆç¬¬ä¸‰æ–¹TTSæœåŠ¡ï¼Œå¦‚Google TTS APIç­‰
      // ç”±äºéœ€è¦APIå¯†é’¥ï¼Œè¿™é‡Œä½¿ç”¨ç®€å•çš„æ–‡æœ¬æç¤º
    }
    
    // iOS Safariä¸“ç”¨ä¼˜åŒ–ï¼šæ£€æµ‹iOSè®¾å¤‡å¹¶åº”ç”¨ç‰¹æ®Šé…ç½®
    function isIOS() {
      return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }
    
    // iOS Safariè¯­éŸ³ä¼˜åŒ–é…ç½®
    function setupIOSSpeechSynthesis() {
      if (!isIOS()) return;
      
      console.log('æ£€æµ‹åˆ°iOSè®¾å¤‡ï¼Œåº”ç”¨è¯­éŸ³ä¼˜åŒ–é…ç½®');
      
      // iOS Safariå¯èƒ½éœ€è¦ç”¨æˆ·äº¤äº’æ‰èƒ½æ’­æ”¾éŸ³é¢‘
      // æ·»åŠ ä¸€ä¸ªç”¨æˆ·äº¤äº’äº‹ä»¶æ¥åˆå§‹åŒ–éŸ³é¢‘ç³»ç»Ÿ
      document.addEventListener('click', function initAudioOnInteraction() {
        if (audioCtx && audioCtx.state === 'suspended') {
          audioCtx.resume();
        }
        // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼Œé¿å…é‡å¤æ‰§è¡Œ
        document.removeEventListener('click', initAudioOnInteraction);
      }, { once: true });
    }

    function animateWord(base, changed, type) {
      playSoundEffect('magic');
      speakText(`${base} becomes ${changed}`);
    }

    // --- Flashcard åŠŸèƒ½ ---
    function flipCard(card) {
      card.classList.toggle('flipped');
      playSoundEffect('magic');
      
      // æ›´æ–°å·²é€‰æ‹©å¡ç‰‡è®¡æ•°
      updateSelectedCount();
    }

    function filterCards(rule) {
      // æ›´æ–°æŒ‰é’®çŠ¶æ€
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // æ˜¾ç¤º/éšè—å¡ç‰‡
      const cards = document.querySelectorAll('.flashcard-container');
      cards.forEach(card => {
        if (rule === 'all' || card.dataset.rule === rule) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
      
      playSoundEffect('correct');
    }

    function updateSelectedCount() {
      const flippedCards = document.querySelectorAll('.flashcard.flipped');
      const countElement = document.getElementById('selected-count');
      countElement.textContent = flippedCards.length;
    }

    function resetAllCards() {
      const cards = document.querySelectorAll('.flashcard');
      cards.forEach(card => {
        card.classList.remove('flipped');
      });
      updateSelectedCount();
      playSoundEffect('correct');
    }

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      // åˆå§‹åŒ–iOS Safariä¼˜åŒ–é…ç½®
      setupIOSSpeechSynthesis();
      updateSelectedCount();
      
      // ä¸ºæ¯ä¸ªå¡ç‰‡æ·»åŠ è¯­éŸ³åŠŸèƒ½
      const cards = document.querySelectorAll('.flashcard');
      cards.forEach(card => {
        card.addEventListener('click', function() {
          const verbBase = card.querySelector('.verb-base').textContent;
          if (card.classList.contains('flipped')) {
            // æ ¹æ®å¡ç‰‡ç±»å‹å†³å®šæœ—è¯»å†…å®¹
            const ruleType = card.closest('.flashcard-container').dataset.rule;
            if (ruleType === 'continuous') {
              // ç°åœ¨è¿›è¡Œæ—¶å¡ç‰‡ï¼šåªæœ—è¯»ç°åœ¨åˆ†è¯
              const presentParticiple = card.querySelector('.verb-change div:nth-child(1) span').textContent;
              // ç‰¹æ®Šå¤„ç†ï¼šreadçš„ç°åœ¨åˆ†è¯readingå‘éŸ³çº æ­£
              if (verbBase === 'read' && presentParticiple === 'reading') {
                speakText('read reading');
              } else {
                speakText(`${verbBase} ${presentParticiple}`);
              }
            } else {
              // ä¸€èˆ¬ç°åœ¨æ—¶å¡ç‰‡ï¼šåªæœ—è¯»ä¸‰å•å½¢å¼
              const thirdPerson = card.querySelector('.verb-change div:nth-child(1) span').textContent;
              // ç‰¹æ®Šå¤„ç†ï¼šreadçš„ä¸‰å•å½¢å¼readså‘éŸ³çº æ­£
              if (verbBase === 'read' && thirdPerson === 'reads') {
                speakText('read reads');
              } else {
                speakText(`${verbBase} ${thirdPerson}`);
              }
            }
          } else {
            // æ­£é¢ï¼šåªæœ—è¯»åŠ¨è¯åŸå½¢
            // ç‰¹æ®Šå¤„ç†ï¼šreadçš„å‘éŸ³çº æ­£
            if (verbBase === 'read') {
              speakText('read');
            } else {
              speakText(verbBase);
            }
          }
        });
      });
    });

    // --- å‡çº§ç‰ˆé¢˜åº“ (èåˆè¯¾æ–‡å›¾ç‰‡å†…å®¹) ---
    const questions = [
      {
        question: "Look! Li Ming is ___ to the basket.",
        options: ["run", "runs", "running"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>Look!</b> æç¤ºæ­£åœ¨å‘ç”Ÿï¼Œä¸” run æ˜¯é‡è¯»é—­éŸ³èŠ‚ï¼Œéœ€åŒå†™ n åŠ  ingã€‚"
      },
      {
        question: "Li Ming often ___ high in basketball matches.",
        options: ["jump", "jumps", "is jumping"],
        answer: 1,
        explanation: "å…³é”®è¯ <b>often</b> è¡¨ç¤ºä¹ æƒ¯ï¼ŒLi Ming æ˜¯ç¬¬ä¸‰äººç§°å•æ•°ï¼ŒåŠ¨è¯åŠ  sã€‚"
      },
      {
        question: "What is Peter doing? He is ___ the ball.",
        options: ["shooting", "shoots", "shoot"],
        answer: 0,
        explanation: "é—®å¥ç”¨ is...doingï¼Œå›ç­”ä¹Ÿè¦ç”¨è¿›è¡Œæ—¶ shootingã€‚"
      },
      {
        question: "They ___ a basketball match right now.",
        options: ["have", "has", "are having"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>right now</b> (ç«‹åˆ»/ç°åœ¨) æç¤ºä½¿ç”¨ç°åœ¨è¿›è¡Œæ—¶ã€‚"
      },
      {
        question: "We usually ___ basketball on Fridays.",
        options: ["play", "plays", "are playing"],
        answer: 0,
        explanation: "å…³é”®è¯ <b>usually</b>ï¼Œä¸»è¯­ We æ˜¯å¤æ•°ï¼Œç”¨åŠ¨è¯åŸå½¢ playã€‚"
      },
      {
        question: "Look at the boy! He ___ the ball.",
        options: ["get", "gets", "is getting"],
        answer: 2,
        explanation: "Look! æç¤ºåŠ¨ä½œæ­£åœ¨è¿›è¡Œï¼Œget éœ€åŒå†™ t åŠ  ingã€‚"
      },
      {
        question: "Does Li Ming play well? Yes, he ___ well.",
        options: ["play", "plays", "is playing"],
        answer: 1,
        explanation: "è¿™æ˜¯è¯„ä»·èƒ½åŠ›/äº‹å®ï¼Œç”¨ä¸€èˆ¬ç°åœ¨æ—¶ã€‚He åé¢åŠ¨è¯åŠ  sã€‚"
      },
      {
        question: "Listen! The girls ___ in the classroom.",
        options: ["sing", "sings", "are singing"],
        answer: 2,
        explanation: "<b>Listen!</b> æš—ç¤ºåŠ¨ä½œæ­£åœ¨è¿›è¡Œã€‚"
      },
      {
        question: "He ___ to school every day.",
        options: ["walk", "walks", "is walking"],
        answer: 1,
        explanation: "<b>Every day</b> æ˜¯å…¸å‹çš„ä¸€èˆ¬ç°åœ¨æ—¶æ ‡å¿—ã€‚"
      },
      {
        question: "___ they doing well? Yes, they are.",
        options: ["Do", "Is", "Are"],
        answer: 2,
        explanation: "è¿›è¡Œæ—¶é—®å¥ç»“æ„ï¼šBeåŠ¨è¯ + ä¸»è¯­ + doingã€‚ä¸»è¯­ They ç”¨ Areã€‚"
      }
    ];

    // æ—¶æ€å¯¹æ¯”ç»ƒä¹ é¢˜
    const comparisonQuestions = [
      {
        question: "Look! Li Ming ___ to the basket.",
        options: ["run", "runs", "is running"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>Look!</b> æç¤ºæ­£åœ¨å‘ç”Ÿï¼Œç”¨ç°åœ¨è¿›è¡Œæ—¶ is runningã€‚"
      },
      {
        question: "Li Ming usually ___ high in basketball matches.",
        options: ["jump", "jumps", "is jumping"],
        answer: 1,
        explanation: "å…³é”®è¯ <b>usually</b> è¡¨ç¤ºä¹ æƒ¯ï¼Œç”¨ä¸€èˆ¬ç°åœ¨æ—¶ï¼Œä¸»è¯­ Li Ming æ˜¯ç¬¬ä¸‰äººç§°å•æ•°ï¼ŒåŠ¨è¯åŠ  sã€‚"
      },
      {
        question: "Right now, they ___ a basketball match.",
        options: ["have", "has", "are having"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>right now</b> æç¤ºæ­£åœ¨å‘ç”Ÿï¼Œç”¨ç°åœ¨è¿›è¡Œæ—¶ are havingã€‚"
      },
      {
        question: "We often ___ basketball on weekends.",
        options: ["play", "plays", "are playing"],
        answer: 0,
        explanation: "å…³é”®è¯ <b>often</b> è¡¨ç¤ºä¹ æƒ¯ï¼Œä¸»è¯­ We æ˜¯å¤æ•°ï¼Œç”¨åŠ¨è¯åŸå½¢ playã€‚"
      },
      {
        question: "Listen! The children ___ in the playground.",
        options: ["play", "plays", "are playing"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>Listen!</b> æç¤ºæ­£åœ¨å‘ç”Ÿï¼Œç”¨ç°åœ¨è¿›è¡Œæ—¶ are playingã€‚"
      },
      {
        question: "She ___ to school every morning.",
        options: ["walk", "walks", "is walking"],
        answer: 1,
        explanation: "å…³é”®è¯ <b>every morning</b> è¡¨ç¤ºä¹ æƒ¯ï¼Œä¸»è¯­ She æ˜¯ç¬¬ä¸‰äººç§°å•æ•°ï¼ŒåŠ¨è¯åŠ  sã€‚"
      },
      {
        question: "At the moment, he ___ his homework.",
        options: ["do", "does", "is doing"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>at the moment</b> æç¤ºæ­£åœ¨å‘ç”Ÿï¼Œç”¨ç°åœ¨è¿›è¡Œæ—¶ is doingã€‚"
      },
      {
        question: "They always ___ English songs in class.",
        options: ["sing", "sings", "are singing"],
        answer: 0,
        explanation: "å…³é”®è¯ <b>always</b> è¡¨ç¤ºä¹ æƒ¯ï¼Œä¸»è¯­ They æ˜¯å¤æ•°ï¼Œç”¨åŠ¨è¯åŸå½¢ singã€‚"
      },
      {
        question: "Look at the sky! It ___ dark.",
        options: ["get", "gets", "is getting"],
        answer: 2,
        explanation: "å…³é”®è¯ <b>Look at</b> æç¤ºæ­£åœ¨å‘ç”Ÿï¼Œç”¨ç°åœ¨è¿›è¡Œæ—¶ is gettingã€‚"
      },
      {
        question: "My father ___ a newspaper every evening.",
        options: ["read", "reads", "is reading"],
        answer: 1,
        explanation: "å…³é”®è¯ <b>every evening</b> è¡¨ç¤ºä¹ æƒ¯ï¼Œä¸»è¯­ My father æ˜¯ç¬¬ä¸‰äººç§°å•æ•°ï¼ŒåŠ¨è¯åŠ  sã€‚"
      }
    ];

    let currentQuestionIndex = 0;
    let score = 0;
    let currentComparisonQuestionIndex = 0;
    let comparisonScore = 0;
    
    // ä¸°å¯Œçš„åé¦ˆè¯æ±‡æ•°ç»„
    const positiveFeedback = [
      "Well done!",
      "Good job!",
      "Excellent!",
      "Perfect!",
      "Great work!",
      "Awesome!",
      "Fantastic!",
      "Brilliant!",
      "Amazing!",
      "Superb!"
    ];
    
    // éšæœºé€‰æ‹©åé¦ˆè¯æ±‡
    function getRandomFeedback() {
      return positiveFeedback[Math.floor(Math.random() * positiveFeedback.length)];
    }

    // é€‰é¡¹å¡åˆ‡æ¢åŠŸèƒ½
    function switchTab(tabType) {
      // é‡ç½®æ‰€æœ‰é€‰é¡¹å¡æŒ‰é’®æ ·å¼
      document.getElementById('past-tab').style.background = '#ddd';
      document.getElementById('past-tab').style.color = '#666';
      document.getElementById('comparison-tab').style.background = '#ddd';
      document.getElementById('comparison-tab').style.color = '#666';
      
      // éšè—æ‰€æœ‰å†…å®¹
      document.getElementById('past-tab-content').style.display = 'none';
      document.getElementById('comparison-tab-content').style.display = 'none';
      
      // æ¿€æ´»é€‰ä¸­çš„é€‰é¡¹å¡
      if (tabType === 'past') {
        document.getElementById('past-tab').style.background = '#ffa726';
        document.getElementById('past-tab').style.color = 'white';
        document.getElementById('past-tab-content').style.display = 'block';
        loadQuestion();
      } else if (tabType === 'comparison') {
        document.getElementById('comparison-tab').style.background = '#4ecdc4';
        document.getElementById('comparison-tab').style.color = 'white';
        document.getElementById('comparison-tab-content').style.display = 'block';
        loadComparisonQuestion();
      }
    }

    function loadQuestion() {
      const q = questions[currentQuestionIndex];
      document.getElementById('question-text').innerHTML = `${currentQuestionIndex + 1}. ${q.question}`;
      const container = document.getElementById('options-container');
      container.innerHTML = '';

      q.options.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.className = 'exercise-option';
        btn.innerText = opt;
        btn.onclick = () => checkAnswer(idx, btn);
        container.appendChild(btn);
      });

      document.getElementById('next-button').style.display = 'none';
      document.getElementById('result-message').innerText = '';
    }

    function checkAnswer(selectedIndex, btn) {
      const q = questions[currentQuestionIndex];
      const allBtns = document.querySelectorAll('.exercise-option');
      allBtns.forEach(b => b.disabled = true);

      if (selectedIndex === q.answer) {
        btn.classList.add('correct');
        playSoundEffect('correct');
        speakText(getRandomFeedback());
        score++;
        document.getElementById('score').innerText = score;
        document.getElementById('result-message').innerHTML = `<span style='color:green'>âœ… æ­£ç¡®ï¼</span> ${q.explanation}`;
      } else {
        btn.classList.add('incorrect');
        allBtns[q.answer].classList.add('correct');
        playSoundEffect('incorrect');
        speakText("Oops, try again.");
        document.getElementById('result-message').innerHTML = `<span style='color:red'>âŒ é”™è¯¯ã€‚</span> ${q.explanation}`;
      }

      if (currentQuestionIndex < questions.length - 1) {
        document.getElementById('next-button').style.display = 'inline-block';
      } else {
        finishQuiz();
      }
    }

    function nextQuestion() {
      currentQuestionIndex++;
      loadQuestion();
    }

    function finishQuiz() {
      setTimeout(() => {
        let msg = score >= 8 ? "å¤ªæ£’äº†ï¼ç¯®çƒè§£è¯´å‘˜å°±æ˜¯ä½ ï¼ğŸ†" : "åŠ æ²¹ï¼å¤šçœ‹çœ‹æ—¶é—´å…³é”®è¯å“¦ï¼ğŸ’ª";
        document.getElementById('past-tab-content').innerHTML = `
                    <h2>ğŸ‰ æŒ‘æˆ˜å®Œæˆï¼</h2>
                    <p style="font-size: 24px;">å¾—åˆ†: <b style="color:#ffa726">${score} / ${questions.length}</b></p>
                    <p>${msg}</p>
                    <button class="button" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
                `;
        speakText(msg);
      }, 1500);
    }

    // å¯¹æ¯”ç»ƒä¹ åŠŸèƒ½
    function loadComparisonQuestion() {
      const q = comparisonQuestions[currentComparisonQuestionIndex];
      document.getElementById('comparison-question-text').innerHTML = `${currentComparisonQuestionIndex + 1}. ${q.question}`;
      const container = document.getElementById('comparison-options-container');
      container.innerHTML = '';

      q.options.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.className = 'exercise-option';
        btn.innerText = opt;
        btn.onclick = () => checkComparisonAnswer(idx, btn);
        container.appendChild(btn);
      });

      document.getElementById('comparison-next-button').style.display = 'none';
      document.getElementById('comparison-result-message').innerText = '';
    }

    function checkComparisonAnswer(selectedIndex, btn) {
      const q = comparisonQuestions[currentComparisonQuestionIndex];
      const allBtns = document.querySelectorAll('#comparison-options-container .exercise-option');
      allBtns.forEach(b => b.disabled = true);

      if (selectedIndex === q.answer) {
        btn.classList.add('correct');
        playSoundEffect('correct');
        speakText(getRandomFeedback());
        comparisonScore++;
        document.getElementById('comparison-score').innerText = comparisonScore;
        document.getElementById('comparison-result-message').innerHTML = `<span style='color:green'>âœ… æ­£ç¡®ï¼</span> ${q.explanation}`;
      } else {
        btn.classList.add('incorrect');
        allBtns[q.answer].classList.add('correct');
        playSoundEffect('incorrect');
        speakText("Oops, try again.");
        document.getElementById('comparison-result-message').innerHTML = `<span style='color:red'>âŒ é”™è¯¯ã€‚</span> ${q.explanation}`;
      }

      if (currentComparisonQuestionIndex < comparisonQuestions.length - 1) {
        document.getElementById('comparison-next-button').style.display = 'inline-block';
      } else {
        finishComparisonQuiz();
      }
    }

    function nextComparisonQuestion() {
      currentComparisonQuestionIndex++;
      loadComparisonQuestion();
    }

    function finishComparisonQuiz() {
      setTimeout(() => {
        let msg = comparisonScore >= 8 ? "å¤ªæ£’äº†ï¼æ—¶æ€å¯¹æ¯”å¤§å¸ˆå°±æ˜¯ä½ ï¼ğŸ†" : "åŠ æ²¹ï¼å¤šç»ƒä¹ æ—¶æ€å¯¹æ¯”å“¦ï¼ğŸ’ª";
        document.getElementById('comparison-tab-content').innerHTML = `
                    <h2>ğŸ‰ å¯¹æ¯”æŒ‘æˆ˜å®Œæˆï¼</h2>
                    <p style="font-size: 24px;">å¾—åˆ†: <b style="color:#4ecdc4">${comparisonScore} / ${comparisonQuestions.length}</b></p>
                    <p>${msg}</p>
                    <button class="button" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
                `;
        speakText(msg);
      }, 1500);
    }

    // åˆå§‹åŒ–
    loadQuestion();
    document.body.addEventListener('click', initAudio, { once: true });

  </script>
</body>

</html>